{%- liquid
  assign startPage = site | get_page: component.featurettesID
  assign root = startPage | default: site.root_page
  assign label = page.data.customLabel | default: 'map-location'
  assign limit = page.data.limit | default: 20
  assign items = root.descendants | filter_pages: by: "name", sort: "asc", tags: label, tags_match: "all", hidden: page.data.showHidden, random: false, limit: limit
  assign sortedItems = items | sort: "name"
  assign i = 0
-%}
{
  "places": [
    {%- for item in items -%}{%- if item.data.thumbnail_url != blank -%}{%- assign thumbnailSrc = item.data.thumbnail_url | build_image_url: size: '960x640', format: 'webp' -%}{%- endif -%}{
      "title": "{{ item.alternate_name | default: item.name }}",
      "img": "<img class=\"w-100 mb-1\" src=\"{{ thumbnailSrc }}\" alt='{{ item.data.thumbnail_alt }}'>",
      "address": "<address><strong>{{ item.content['wvu-place-1__address-line-1'] }}{% if item.content['wvu-place-1__address-line-2'] != blank %}<br>{{ item.content['wvu-place-1__address-line-2'] }}{% endif %}</strong></address>",
      "description": "<p>{{ item.data.description }}</p>",
      "lat": "{{ item.data.lat | strip }}",
      "lng": "{{ item.data.long | strip }}",
      "url": "<a class=\"text-primary text-decoration-none\" href=\"{{ item.content['wvu-place-1__map-link'] }}\">Visit Website<span class=\"visually-hidden\">: {{ item.alternate_name | default: item.name }}</span> <span class=\"fa-solid fa-arrow-right\"></span></a>"
    }{%- assign i = i | plus: 1 -%}{%- if i < items.length -%},{%- endif -%}{%- endfor -%}
  ]
}
